(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[717],{9595:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/usages",function(){return n(679)}])},3657:function(e,t,n){"use strict";n.d(t,{M:function(){return f}});var r=n(2670),a=n(5893),o=n(4184),s=n.n(o),l=n(3067),i=n.n(l),u=n(1163),c=(n(7294),n(9713)),d=n(1211);function f(e){var t=e.date,n=e.className,o=void 0===n?"":n,l=e.containerClassName,f=void 0===l?"":l,h=e.full,m=void 0!==h&&h,p=e.precision,x=void 0!==p&&p,g=e.locale,v=void 0===g?"":g,b=e.options,w=void 0===b?void 0:b,j=(0,u.useRouter)(),N="en"==(null!==v&&void 0!==v?v:j.query.date);if(!t)return(0,a.jsx)(a.Fragment,{children:"-"});t=(0,r.Z)(t,Date)?t:new Date(t);var y=new Intl.DateTimeFormat(N?"en-US":"fa-IR-u-nu-latn",null!==w&&void 0!==w?w:{timeStyle:"medium",dateStyle:"full"}),D=x?(0,c.Bh)(t).text:i()(t).locale("fa").fromNow(),k=y.format(t);return m?(0,a.jsx)(d.G,{className:f,popup:(0,a.jsx)("span",{dir:"rtl",children:D}),children:(0,a.jsx)("span",{className:s()("block text-gray-900 text-rtl",o),children:k})}):(0,a.jsx)(d.G,{popup:k,className:f,children:(0,a.jsx)("span",{className:s()("block text-gray-500 text-rtl",o),children:D})})}},5835:function(e,t,n){"use strict";n.d(t,{B:function(){return l},k:function(){return s}});var r=n(5893),a=n(4184),o=n.n(a);function s(e){var t=e.label,n=e.children,a=e.className,s=void 0===a?"":a;return(0,r.jsxs)("div",{className:o()("flex flex-row border-b-[1px] border-b-gray-200 last:border-b-0",s),children:[(0,r.jsx)("span",{className:"flex-1 text-gray-400 mr-2",children:t}),n]})}function l(e){var t=e.children,n=e.className,a=void 0===n?"":n;return(0,r.jsx)("div",{className:o()("flex flex-col",a),children:t})}},1211:function(e,t,n){"use strict";n.d(t,{G:function(){return l}});var r=n(5893),a=n(4184),o=n.n(a),s=n(7294);function l(e){var t=e.children,n=e.popup,a=e.className,l=void 0===a?"":a,i=(0,s.useState)(!1),u=i[0],c=i[1];return n?(0,r.jsxs)("div",{className:o()("inline relative cursor-help",l),onMouseOver:function(){return c(!0)},onMouseOut:function(){return c(!1)},children:[t,u?(0,r.jsx)("div",{className:"shadow-lg z-10 absolute top-full rounded-lg bg-white px-2 py-2 ring-1 ring-slate-400",children:n}):null]}):t}},679:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return j}});var r=n(828),a=n(5893),o=n(4184),s=n.n(o),l=n(9008),i=n.n(l),u=n(1163),c=n(7294),d=n(8100),f=n(1272),h=n(1257),m=n(3657),p=n(6550),x=n(5835),g=n(4685),v=n(2687),b=n(5384),w=n(9713);function j(){var e=(0,c.useContext)(f.I),t=(0,u.useRouter)(),n="1"==t.query.all,o=t.query.user,l=(0,r.Z)((0,v.Ai)("usages-view",{showDetail:!!n}),2),j=l[0],N=l[1],y=(0,d.ZP)(o?"/daily_usages?email="+o+"&key="+btoa(e.server.url):null,w.Pu.bind(this,e.server)),D=y.data,k=(y.mutate,y.isValidating);(0,v.G)();return(0,a.jsxs)(h.W,{children:[(0,a.jsx)(i(),{children:(0,a.jsx)("title",{children:"Usages"})}),(0,a.jsxs)(p.H_,{title:"Daily Usages",data:j,dataSetter:N,horizontal:!0,children:[(0,a.jsx)(p.gN,{label:"User",className:"border-x-[1px] px-3 mr-2",children:(0,a.jsx)("span",{className:"text-gray-800 py-1 px-2 rounded-lg bg-yellow-100",children:o})}),n?(0,a.jsx)(p.gN,{label:"Show Detail",htmlFor:"showDetail",children:(0,a.jsx)("input",{type:"checkbox",id:"showDetail"})}):null]}),(0,a.jsx)(g.i,{rows:null!==D&&void 0!==D?D:[],loading:k,groupBy:function(e){return new Intl.DateTimeFormat("fa-IR",{month:"long",year:"numeric"}).format(new Date(e.date))},group:function(e){return(0,a.jsx)("tr",{className:"sticky top-[31px] z-50 bg-white shadow-sm",children:(0,a.jsx)("td",{colSpan:5,className:"px-10 py-2 text-base font-bold",children:e})})},columns:["Date","First connect","Last connect","Requests"],cells:function(e){return[(0,a.jsx)(m.M,{options:{dateStyle:"full"},date:e.date,full:!0,containerClassName:"text-center"}),j.showDetail?(0,a.jsx)(x.B,{children:e.outbounds.map((function(e){return(0,a.jsx)(x.k,{label:e.tag,children:new Date(e.firstConnect).toLocaleTimeString()})}))}):e.outbounds.filter((function(e){return"direct"==e.tag})).map((function(e){return new Date(e.firstConnect).toLocaleTimeString()})).pop(),j.showDetail?(0,a.jsx)(x.B,{children:e.outbounds.map((function(e){return(0,a.jsx)(x.k,{label:e.tag,children:new Date(e.lastConnect).toLocaleTimeString()})}))}):e.outbounds.filter((function(e){return"direct"==e.tag})).map((function(e){return new Date(e.lastConnect).toLocaleTimeString()})).pop(),j.showDetail?(0,a.jsx)(x.B,{children:e.outbounds.map((function(e){return(0,a.jsxs)(x.k,{label:e.tag,children:[e.counter," requests",n?(0,a.jsx)("a",{className:s()(b.W.link,"pl-2"),href:"/usages/logs?all=".concat(n?1:0,"&user=").concat(o,"&tag=").concat(e.tag,"&from=").concat(e.firstConnectLogOffset,"&to=").concat(e.lastConnectLogOffset),children:" (Logs)"}):null]})}))}):e.outbounds.filter((function(e){return"direct"==e.tag})).map((function(e){return"".concat(e.counter," requests")})).pop()]}})]})}},828:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(3375);var a=n(1566);function o(e,t){return function(e){if(Array.isArray(e))return e}(e)||(0,r.Z)(e,t)||(0,a.Z)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}}},function(e){e.O(0,[885,966,58,923,774,888,179],(function(){return t=9595,e(e.s=t);var t}));var t=e.O();_N_E=t}]);